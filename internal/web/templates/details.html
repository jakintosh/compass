{{define "details"}}
<div class="slideover" onclick="event.stopPropagation()">
    <div class="slideover-header">
        <h2 class="slideover-title">Task Details</h2>
        <button class="btn slideover-close" onclick="document.getElementById('slideover-container').innerHTML = ''">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        </button>
    </div>

    <div class="slideover-body">
        <div class="form-field">
            <label class="field-label">Name</label>
            <input type="text" value="{{.Name}}" class="field-input" hx-patch="/tasks/{{.ID}}" hx-trigger="change"
                name="name" hx-swap="none">
        </div>

        <div class="form-field">
            <label class="field-label">Description</label>
            <textarea rows="5" class="field-textarea" placeholder="Add a description..." hx-patch="/tasks/{{.ID}}"
                hx-trigger="change" name="description" hx-swap="none">{{.Description}}</textarea>
        </div>

        <div class="subtasks-section">
            <div class="subtasks-header">
                <label class="field-label">Subtasks</label>
            </div>

            <div id="subtasks-list-{{.ID}}" class="subtasks-list">
                {{range .Subtasks}}
                {{template "subtask" .}}
                {{end}}
            </div>

            <button class="btn btn-add" hx-post="/tasks/{{.ID}}/subtasks" hx-target="#subtasks-list-{{.ID}}"
                hx-swap="beforeend">
                <span class="arrow">+</span>
                <span>Add subtask</span>
            </button>
        </div>
    </div>
</div>
{{end}}

{{define "subtask"}}
<div class="subtask" data-subtask-id="{{.ID}}">
    <div class="subtask-handle drag-handle">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <circle cx="9" cy="12" r="1" />
            <circle cx="9" cy="5" r="1" />
            <circle cx="9" cy="19" r="1" />
            <circle cx="15" cy="12" r="1" />
            <circle cx="15" cy="5" r="1" />
            <circle cx="15" cy="19" r="1" />
        </svg>
    </div>

    <input type="text" value="{{.Name}}" class="subtask-input" placeholder="Subtask name..."
        hx-patch="/subtasks/{{.ID}}" hx-trigger="change" name="name" hx-swap="none">

    <div class="subtask-slider">
        <input type="range" min="0" max="100" value="{{.Completion}}" class="range-slider" name="completion"
            hx-patch="/subtasks/{{.ID}}" hx-trigger="change" hx-swap="none">
    </div>
</div>
{{end}}